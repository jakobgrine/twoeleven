function t(t,s,e){return s in t?Object.defineProperty(t,s,{value:e,enumerable:!0,configurable:!0,writable:!0}):t[s]=e,t}let s;var e;(e=s||(s={}))[e.Left=0]="Left",e[e.Up=1]="Up",e[e.Right=2]="Right",e[e.Down=3]="Down";class i{reset(){this.score=0,this.gameOver=!1,this.board=new Array(this.size*this.size).fill(0),this.spawnRandomTile(),this.spawnRandomTile(),this.save()}save(){}apply(){const t=document.getElementById("board-foreground");let s="";for(let t=0;t<this.size;t++)for(let e=0;e<this.size;e++){const i={x:e,y:t};if(this.has(i)){s+=`<div class="tile tile-${this.get(i)}" style="--y: ${t}; --x: ${e};"></div>`}}t.innerHTML=s}action(t){switch(t){case s.Left:return this.left();case s.Up:return this.up();case s.Right:return this.right();case s.Down:return this.down()}}left(){const t=this.merge(),s=this.move();return this.score+=t,!!(t>0||s)&&(this.score>this.highscore&&(this.highscore=this.score),this.spawnRandomTile(),this.isGameOver()&&(this.gameOver=!0),!0)}up(){this.transpose();const t=this.left();return this.transpose(),t}right(){this.transpose(),this.reflect(),this.transpose();const t=this.left();return this.transpose(),this.reflect(),this.transpose(),t}down(){this.reflect(),this.transpose();const t=this.left();return this.transpose(),this.reflect(),t}isGameOver(){for(let t=0;t<this.size;t++)for(let s=0;s<this.size;s++){const e={x:s,y:t};if(!this.has(e))return!1;const i={x:s+1,y:t};if(this.get(e)==this.get(i))return!1;const r={x:s,y:t+1};if(this.get(e)==this.get(r))return!1}return!0}spawnRandomTile(){const t=new Array;for(let s=0;s<this.size;s++)for(let e=0;e<this.size;e++){const i={x:e,y:s};this.has(i)||t.push(i)}const s=Math.floor(Math.random()*t.length),e=Math.random()>.9?4:2;this.set(t[s],e)}transpose(){const t=new Array(this.size*this.size).fill(0);for(let s=0;s<this.size;s++)for(let e=0;e<this.size;e++){const i=this.get({x:e,y:s});t[s+e*this.size]=i}this.board=t}reflect(){const t=new Array(this.size*this.size).fill(0);for(let s=0;s<this.size;s++)for(let e=0;e<this.size;e++){const i=this.get({x:e,y:s});t[e+(this.size-s-1)*this.size]=i}this.board=t}merge(){let t=0;for(let s=0;s<this.size;s++)for(let e=0;e<this.size;e++){const i={x:e,y:s};if(this.has(i))for(let r=e+1;r<this.size;r++){const e={x:r,y:s};if(this.has(e)){if(this.get(i)==this.get(e)){const s=this.get(i);this.set(i,2*s),this.delete(e),t+=2*s}break}}}return t}move(){let t=!1;for(let s=0;s<this.size;s++)for(let e=0;e<this.size;e++){const i={x:e,y:s};if(!this.has(i))for(let r=e+1;r<this.size;r++){const e={x:r,y:s};if(this.has(e)){this.set(i,this.get(e)),this.delete(e),t=!0;break}}}return t}get(t){return this.board[t.x+t.y*this.size]}set(t,s){this.board[t.x+t.y*this.size]=s}has(t){return this.get(t)>0}delete(t){this.set(t,0)}print(){let t="";for(let s=0;s<this.size;s++)t+=this.board.slice(s*this.size,(s+1)*this.size).join(" "),t+="\n";console.log(t),console.log(this.board)}constructor(s){t(this,"size",4),t(this,"gameOver",!1),t(this,"score",0),t(this,"highscore",0),this.size=s,this.reset()}}window.addEventListener("load",(function(){const t=new i(4);window.addEventListener("keydown",(e=>{switch(e.code){case"ArrowLeft":case"ArrowUp":case"ArrowRight":case"ArrowDown":const i=s[e.code.replace("Arrow","")];t.action(i)&&t.apply()}}))}));
//# sourceMappingURL=index.3204183d.js.map
